Today maybe raining, temp: ${{on.weather.outputs.current[0].temp}}째, ${{on.weather.outputs.daily[0].weather[0]description}}
on:
  weather:
    apiKey: ${{ secrets.OPENWEATHERMAP_API_KEY }}
    params:
      lat: ${{ secrets.LAT }}
      lon: ${{ secrets.LON }}
      lang: de
      units: metric
    #every: "30 6 * * 1-5"
    timeZone: Europe/Berlin

jobs:
  print:
    name: Print
    runs-on: ubuntu-latest
    steps:
      - name: Print Outputs
        env:
          message: |
            temp: ${{on.weather.outputs.current.temp}}째, ${{on.weather.outputs.daily[0].weather[0].description}}
        run: |
          echo message: $message
      - name: Slack notification daily
        uses: Ilshidur/action-slack@2.1.0
        env:
          curtemp: ${{on.weather.outputs.current.temp}}
          maxtemp: ${{on.weather.outputs.daily[0].temp.day}}
          summary: ${{on.weather.outputs.daily[0].weather[0].description}}
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEATHER_BOT }}
          SLACK_CUSTOM_PAYLOAD: '{ "text": "Wetterinfo {{ summary }} ", "blocks": [ { "type": "header", "text": { "type": "plain_text", "text": ":thermometer: Wetterinfo {{ summary }} ", "emoji": true } },{ "type": "section", "text": { "type": "mrkdwn", "text": " Aktuelle Temperatur liegt bei {{ curtemp }} 째C, die Maximaltemperatur wird bei {{ maxtemp }} 째C liegen" } }, { "type": "divider" } ] }'
      - name: Slack notification rain
        uses: Ilshidur/action-slack@2.1.0
        if: on.weather.outputs.current.weather.0.main == 'Rain'
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEATHER_BOT }}
          SLACK_CUSTOM_PAYLOAD: '{ "text": "Regen ", "blocks": [ { "type": "header", "text": { "type": "plain_text", "text": ":thermometer: Wetterinfo {{ summary }} ", "emoji": true } },{ "type": "section", "text": { "type": "mrkdwn", "text": "Du solltest den Regenschirm mitnehmen" } }, { "type": "divider" } ] }'
      - name: Slack notification Clouds
        uses: Ilshidur/action-slack@2.1.0
        if: on.weather.outputs.current.weather.0.main == 'Clouds'
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEATHER_BOT }}
          SLACK_CUSTOM_PAYLOAD: '{ "text": "Wolken ", "blocks": [ { "type": "header", "text": { "type": "plain_text", "text": ":thermometer: Wetterinfo {{ summary }} ", "emoji": true } },{ "type": "section", "text": { "type": "mrkdwn", "text": "Grau, grau grau in grau" } }, { "type": "divider" } ] }'
